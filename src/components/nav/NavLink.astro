---
import type { HTMLAttributes } from "astro/types";

interface Props extends HTMLAttributes<"a"> {
	href: string;
	activeClass?: string;
	prefetch?: boolean;
}

const {
	href,
	class: className = "",
	activeClass,
	prefetch = true,
	...rest
} = Astro.props as Props;

const isInternal = href.startsWith("/") && !href.startsWith("//");
const isExternal =
	href.startsWith("http://") ||
	href.startsWith("https://") ||
	href.startsWith("mailto:") ||
	href.startsWith("tel:") ||
	href.startsWith("#");

const shouldPrefetch = isInternal && !isExternal && prefetch;
const isActive = Astro.url.pathname === href;
const classes = [className, isActive && activeClass].filter(Boolean).join(" ");
---

<a
  href={href}
  class={classes}
  data-astro-prefetch={shouldPrefetch ? true : undefined}
  {...rest}
>
  <slot />
</a>
